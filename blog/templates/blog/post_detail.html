{% extends "base.html" %}
{% load static %}

{% block title %}{{ post.title }} | Rachell Calhoun{% endblock %}

{% block meta_tags %}
<meta name="description" content="{{ post.get_excerpt }}" />
<meta name="author" content="Rachell Calhoun" />

<!-- Open Graph / Facebook -->
<meta property="og:type" content="article" />
<meta property="og:title" content="{{ post.title }}" />
<meta property="og:description" content="{{ post.get_excerpt }}" />
{% if post.get_first_image %}
<meta property="og:image" content="{{ post.get_first_image }}" />
{% elif post.img %}
<meta property="og:image" content="{{ post.img.url }}" />
{% else %}
<meta property="og:image" content="https://avatars3.githubusercontent.com/u/10239547?v=3&s=466" />
{% endif %}
<meta property="og:url" content="https://www.rachellcalhoun.com/post/{{ post.slug }}/" />
<meta property="article:published_time" content="{{ post.published_date|date:'c' }}" />
<meta property="article:author" content="Rachell Calhoun" />

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="{{ post.title }}" />
<meta name="twitter:description" content="{{ post.get_excerpt }}" />
{% if post.get_first_image %}
<meta name="twitter:image" content="{{ post.get_first_image }}" />
{% elif post.img %}
<meta name="twitter:image" content="{{ post.img.url }}" />
{% else %}
<meta name="twitter:image" content="https://avatars3.githubusercontent.com/u/10239547?v=3&s=466" />
{% endif %}
{% endblock %}

{% block header %}
<div class="blogheader">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8 text-center">
                <div class="blogtitle">
                    <h1 class="display-4 mb-3">{{ post.title }}</h1>
                    {% if post.published_date %}
                    <div class="mb-3">
                        <p class="mb-2 text-white">
                            <i class="fas fa-calendar-alt"></i> {{ post.published_date|date:"F d, Y" }} â€¢ <i class="fas fa-user"></i> {{ post.author }}
                        </p>
                        <a href="/blog" class="btn btn-outline-light btn-sm">
                            <i class="fas fa-arrow-left"></i> Back to Blog
                        </a>
                    </div>
                    {% else %}
                        {% if user.is_authenticated %}
                        <a class="btn btn-success" href="{% url 'post_publish' pk=post.pk %}">
                            <i class="fas fa-share"></i> Publish Post
                        </a>
                        {% endif %}
                    {% endif %}

                    {% if user.is_authenticated %}
                    <div class="admin-controls mt-3">
                        <a class="btn btn-outline-warning btn-sm" href="{% url "post_edit" pk=post.pk %}">
                            <i class="fas fa-edit"></i> Edit
                        </a>
                        <a class="btn btn-outline-danger btn-sm ms-2" href="{% url "post_remove" pk=post.pk %}">
                            <i class="fas fa-trash"></i> Delete
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block content %}
<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <article class="blog-post">
                {% if post.img %}
                <div class="text-center mb-4">
                    <img class="img-fluid rounded shadow" src="{{ post.img.url }}" alt="{{ post.title }}" loading="lazy">
                </div>
                {% endif %}

                <div class="blog-content">
                    {{ post.text|safe }}
                </div>
            </article>
        </div>
    </div>
</div>

<script>
document.querySelectorAll('.blog-content img').forEach(img => {
    img.setAttribute('loading', 'lazy');
});
</script>
{% endblock %}
